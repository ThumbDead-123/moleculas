<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Visualización Didáctica de la Molécula de Fructosa</title>
    <!-- Incluir A-Frame -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <!-- Incluir A-Frame Extras para efectos de partículas -->
    <script src="https://unpkg.com/aframe-extras@6.1.0/dist/aframe-extras.min.js"></script>
    <!-- Incluir Speech Synthesis API para audio narrativo -->
    <script>
      function narrar(texto) {
        const speech = new SpeechSynthesisUtterance(texto);
        speech.lang = "es-ES";
        window.speechSynthesis.speak(speech);
      }
    </script>
  </head>

  <body>
    <!-- Escena A-Frame -->
    <a-scene background="color: #000000">
      <!-- Fondo espacial para una experiencia inmersiva -->
      <a-sky color="#000"></a-sky>

      <!-- Texto que dice "Fructosa" encima del modelo -->
      <a-text value="Fructosa - C6H12O6" color="#FFFFFF" position="0 3 -5" align="center" scale="3 3 3"></a-text>

      <!-- Modelo de la molécula de fructosa con texturas avanzadas -->
      <a-entity id="fructosa" obj-model="obj: #fructosa-obj; mtl: #fructosa-mtl" position="0 1.5 -5" scale="0.2 0.2 0.2"></a-entity>

      <!-- Efectos de partículas simulando átomos -->
      <a-entity particle-system="preset: dust; color: #ff0000, #00ff00; particleCount: 200" position="0 2 -5"></a-entity>

      <!-- Definir los assets (archivos) -->
      <a-assets>
        <a-asset-item id="fructosa-obj" src="fructosa.obj"></a-asset-item>
        <a-asset-item id="fructosa-mtl" src="fructosa.mtl"></a-asset-item>
      </a-assets>

      <!-- Añadir luces mejoradas para destacar detalles -->
      <a-light type="ambient" color="#ffffff" intensity="0.3"></a-light>
      <a-light type="point" intensity="1.5" position="2 4 -3" distance="15"></a-light>

      <!-- Añadir cámara con controles VR -->
      <a-camera id="camera" position="0 1.6 0" wasd-controls-enabled="false" look-controls="enabled: true">
        <a-cursor></a-cursor>
      </a-camera>

      <!-- Instrucciones interactivas -->
      <a-text value="Haz clic en partes de la molécula para aprender más." color="#FFFFFF" position="0 0.8 -3" align="center" scale="1.5 1.5 1.5"></a-text>

      <!-- Añadir botones de interacción para zoom y quiz -->
      <a-entity id="zoom-in" geometry="primitive: plane; width: 0.5; height: 0.5" material="color: green" position="-1 0 -2">
        <a-text value="+" color="#FFFFFF" position="-0.15 0.15 0" scale="2 2 2"></a-text>
      </a-entity>
      <a-entity id="zoom-out" geometry="primitive: plane; width: 0.5; height: 0.5" material="color: red" position="1 0 -2">
        <a-text value="-" color="#FFFFFF" position="-0.15 0.15 0" scale="2 2 2"></a-text>
      </a-entity>

      <!-- Botón de quiz -->
      <a-entity id="quiz" geometry="primitive: plane; width: 1; height: 0.5" material="color: blue" position="0 -1 -2">
        <a-text value="Quiz: ¿Cuántos átomos de oxígeno hay en la fructosa?" color="#FFFFFF" position="-0.9 0.15 0" scale="1 1 1"></a-text>
      </a-entity>

      <!-- Botón de respuesta correcta -->
      <a-entity id="quiz-answer-1" geometry="primitive: plane; width: 0.5; height: 0.5" material="color: yellow" position="-0.5 -1.5 -2">
        <a-text value="6" color="#FFFFFF" position="-0.15 0.15 0" scale="2 2 2"></a-text>
      </a-entity>

      <!-- Botón de respuesta incorrecta -->
      <a-entity id="quiz-answer-2" geometry="primitive: plane; width: 0.5; height: 0.5" material="color: yellow" position="0.5 -1.5 -2">
        <a-text value="5" color="#FFFFFF" position="-0.15 0.15 0" scale="2 2 2"></a-text>
      </a-entity>

      <!-- Script para controlar la interacción y el quiz -->
      <script>
        document.addEventListener('DOMContentLoaded', () => {
          const camera = document.querySelector('#camera');
          const fructosa = document.querySelector('#fructosa');
          const zoomIn = document.querySelector('#zoom-in');
          const zoomOut = document.querySelector('#zoom-out');
          const quizAnswer1 = document.querySelector('#quiz-answer-1');
          const quizAnswer2 = document.querySelector('#quiz-answer-2');

          let scale = 0.2; // Escala inicial de la molécula
          let rotating = true;
          let rotationSpeed = 0.5;

          // Narrar la introducción
          narrar("Bienvenidos a la experiencia de aprendizaje de la molécula de fructosa. Usa los controles para interactuar.");

          // Función para ajustar la escala de la molécula
          function adjustScale(delta) {
            scale += delta;
            if (scale < 0.05) scale = 0.05; // Límite inferior
            if (scale > 1) scale = 1; // Límite superior
            fructosa.setAttribute('scale', `${scale} ${scale} ${scale}`);
          }

          // Interacción con los botones de zoom
          zoomIn.addEventListener('click', () => adjustScale(0.05));
          zoomOut.addEventListener('click', () => adjustScale(-0.05));

          // Función para rotar la molécula
          function rotateModel() {
            if (rotating) {
              let rotation = fructosa.getAttribute('rotation');
              rotation.y += rotationSpeed; // Rotación constante en el eje Y
              fructosa.setAttribute('rotation', rotation);

              // Seguir rotando en el siguiente frame
              requestAnimationFrame(rotateModel);
            }
          }

          rotateModel(); // Iniciar la rotación

          // Responder al quiz
          quizAnswer1.addEventListener('click', () => {
            narrar("¡Correcto! La fructosa tiene 6 átomos de oxígeno.");
          });

          quizAnswer2.addEventListener('click', () => {
            narrar("Incorrecto. Intenta de nuevo.");
          });
        });
      </script>

    </a-scene>
  </body>
</html>
